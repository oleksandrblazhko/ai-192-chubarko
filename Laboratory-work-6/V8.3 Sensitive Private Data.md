## V8.3 Конфіденційні приватні дані

Цей розділ допомагає захистити конфіденційні дані від створення, читання, оновлення чи видалення без авторизації, особливо в великих кількостях.

Відповідність вимогам цього розділу означає відповідність вимогам V4 Access Control, зокрема V4.2. Наприклад, для захисту від неавторизованих оновлень або розголошення конфіденційної особистої інформації вимагає дотримання

V4.2.1. Будь ласка, дотримуйтеся цього розділу та V4 для повного покриття.

Примітка. Положення та закони щодо конфіденційності, наприклад Австралійські принципи конфіденційності APP-11 або GDPR, безпосередньо впливають на як програми повинні підходити до реалізації зберігання, використання та передачі конфіденційної особистої інформації.

Це варіюється від суворих покарань до простих порад. Зверніться до місцевих законів і правил, і за потреби проконсультуйтеся з кваліфікованим фахівцем з конфіденційності або юристом.

| # | Опис | L1 | L2 | L3 | CWE |
|---|------|----|----|----|-----|
|8.3.1| Переконайтеся, що конфіденційні дані надсилаються на сервер у тілі повідомлення HTTP або заголовки, і що параметри рядка запиту з будь-якого дієслова HTTP не містять конфіденційні дані.| ✓ | ✓ | ✓ | 319 |
|8.3.2| Переконайтеся, що користувачі мають спосіб видаляти або експортувати свої дані на вимогу.| ✓ | ✓ | ✓ | 212 |
|8.3.3| Переконайтеся, що користувачам надано чітку мову щодо збору та використання надали особисту інформацію та дали користувачі згоду на підключення для використання цих даних до того, як вони будуть використані будь-яким способом. | ✓ | ✓ | ✓ | 285 |
|8.3.4| Перевірте наявність усіх конфіденційних даних, створених і оброблених програмою визначено, і переконайтеся, що існує політика щодо того, як з ними поводитися конфіденційні дані. (C8) | ✓ | ✓ | ✓ | 200 |
|8.3.5| Переконайтеся, що доступ до конфіденційних даних перевірено (без реєстрації конфіденційних даних себе), якщо дані збираються згідно з відповідними директивами щодо захисту даних або де потрібне реєстрування доступу.| | ✓ | ✓ | 532 |
|8.3.6| Переконайтеся, що конфіденційна інформація, яка міститься в пам’яті, перезаписується якнайшвидше оскільки більше не потрібно пом’якшувати атаки скидання пам’яті за допомогою нулів або випадкові дані.| |✓| ✓| 226|
|8.3.7| Переконайтеся, що конфіденційна або приватна інформація, яку потрібно зашифрувати, є зашифровані за допомогою затверджених алгоритмів, які забезпечують як конфіденційність, так і цілісність. (C8) | |✓| ✓| 327|
|8.3.8| Переконайтеся, що конфіденційна особиста інформація підлягає зберіганню даних класифікації, так що старі або застарілі дані видаляються автоматично, на a за розкладом або залежно від ситуації. | |✓ |✓ |285|

Розглядаючи захист даних, перш за все слід звернути увагу на масове вилучення або модифікацію або надмірне використання. Наприклад, багато систем соціальних мереж дозволяють користувачам додавати лише 100 нових друзів на день, але неважливо, з якої системи надійшли ці запити. Банківська платформа може захотіти заблокувати більше більше 5 транзакцій на годину, що переказує понад 1000 євро коштів зовнішнім установам. Кожна система

Вимоги, ймовірно, будуть дуже різними, тому, приймаючи рішення про «ненормальний», необхідно враховувати модель загрози та підприємницький ризик. Важливими критеріями є здатність виявляти, стримувати або, бажано, блокувати такі аномальні масові дії.

# C8: Protect Data Everywhere
## Опис

Конфіденційні дані, такі як паролі, номери кредитних карток, медичні записи, особиста інформація та комерційна таємниця, вимагають додаткового захисту, особливо якщо ці дані підпадають під дію законів про конфіденційність (Загальний регламент ЄС щодо захисту даних GDPR), правил захисту фінансових даних, таких як стандарт безпеки даних PCI ( PCI DSS) або іншими правилами.

Зловмисники можуть викрасти дані з веб-додатків і веб-сервісів кількома способами. Наприклад, якщо конфіденційна інформація надсилається через Інтернет без безпеки зв’язку, зловмисник на спільне бездротове з’єднання може побачити та викрасти дані іншого користувача. Крім того, зловмисник може використовувати SQL Injection, щоб викрасти паролі та інші облікові дані з бази даних програм і відкрити цю інформацію для громадськості.

> ## CWE-319: передача конфіденційної інформації у відкритому тексті
> ## Опис
> Продукт передає конфіденційні або важливі для безпеки дані у вигляді відкритого тексту по каналу зв’язку, який можуть пронюхати неавторизовані особи.
> ## Розширений опис
> Зловмисники під час передачі даних можуть «пронюхувати» (контролювати) багато каналів зв’язку. Наприклад, у мережах пакети можуть проходити через багато проміжних вузлів від джерела до місця призначення через Інтернет, внутрішню мережу, хмару тощо. Деякі учасники можуть мати привілейований доступ до мережевого інтерфейсу або будь-якого зв’язку вздовж каналу, наприклад маршрутизатор, але вони можуть бути не авторизовані для збору основних даних. У результаті зловмисники можуть перехопити мережевий трафік, розповсюджуючи критично важливі для безпеки дані.
Застосовні канали зв'язку не обмежуються програмними продуктами. Застосовні канали включають спеціальні апаратні технології, такі як внутрішні апаратні мережі та зовнішні канали налагодження, що підтримують віддалене налагодження JTAG. Якщо засоби пом’якшення не застосовуються для боротьби з супротивниками в рамках моделі загрози продукту, ця слабкість значно знижує складність експлуатації такими супротивниками.
Коли повне спілкування записується або реєструється, як-от із дампом пакетів, зловмисник може спробувати отримати дамп через тривалий час після того, як відбулася передача, і спробувати «пронюхати» відкритий текст із записаного зв’язку в самому дампі. Навіть якщо інформація закодована у спосіб, який не читається людиною, певні методи можуть визначити, яке кодування використовується, а потім декодувати інформацію.
> ## Відповідні платформи
> ### Мови
> Клас: не залежить від мови (поширеність не визначена)
>### Технології
	>Клас: хмарні обчислення (невизначена поширеність)
	>Клас: мобільний (невизначена поширеність)
	>Клас: ICS/OT (часто поширений)
	>Клас: система на чіпі (невизначена поширеність)
	>Тестування/налагодження обладнання (часто поширене)
> ## Загальні наслідки
>|Область застосування | Вплив|
>|-|-|
>| Цілісність<br/>Конфіденційність | Технічний вплив: читання даних програми; Змінити файли або каталоги<br/>Будь-хто може прочитати інформацію, отримавши доступ до каналу, який використовується для спілкування. |
> ## Імовірність експлойту
> Високий
> |Цілісність| Технічний вплив: зміна даних програми; Змінити файли або каталоги<br/> Зловмисник може змінити конфіденційні дані, або записавши дані безпосередньо в сховище даних, яке не має належних обмежень, або отримавши доступ до недостатньо захищеної привілейованої функції для запису даних.|
> |Управління доступом|Технічний вплив: отримати привілеї або присвоїти ідентифікацію<br/> Зловмисник може отримати привілеї шляхом безпосередньої зміни або читання критичних даних або доступу до недостатньо захищених привілейованих функцій.|
>  ## Імовірність експлойту
> Високий

> ## CWE-212: Неналежне видалення конфіденційної інформації перед зберіганням або передачею
> ### Опис
> Продукт зберігає, передає або надає доступ до ресурсу, який містить конфіденційну інформацію, але не видаляє цю інформацію належним чином, перш ніж продукт зробить ресурс доступним для неавторизованих осіб.
> ### Розширений опис
> Ресурси, які можуть містити конфіденційні дані, включають документи, пакети, повідомлення, бази даних тощо. Хоча ці дані можуть бути корисними для окремого користувача або невеликої групи користувачів, які спільно використовують ресурс, можливо, їх потрібно буде видалити, перш ніж ресурс можна буде надати за межами довіреної групи. Процес видалення іноді називають очищенням або скрабуванням.
Наприклад, продукт для редагування документів може не видаляти конфіденційні дані, такі як коментарі рецензентів або локальне ім’я шляху, де зберігається документ. Або проксі-сервер може не видалити внутрішню IP-адресу із заголовків, перш ніж зробити вихідний запит до веб-сайту.
> ### Відповідні платформи
> Мови
Клас: не залежить від мови (поширеність не визначена)
> ### Загальні наслідки
> |Область застосування | Вплив|
>|-|-|
>|Конфіденційність| Технічний вплив: читання файлів або каталогів; Читання даних програми<br/>Конфіденційні дані можуть бути розкриті для неавторизованого учасника в іншій сфері контролю. Це може мати широкий спектр вторинних наслідків, які залежатимуть від того, які дані буде відкрито. Однією з можливостей є розкриття системних даних, що дозволяє зловмиснику створити конкретну, більш ефективну атаку.|

>  ## CWE-285: Неналежний дозвіл
>  ### Опис
> Продукт не виконує або неправильно виконує перевірку авторизації, коли актор намагається отримати доступ до ресурсу або виконати дію.
>  ### Розширений опис
> Якщо припустити, що користувач має певний ідентифікатор, авторизація – це процес визначення того, чи може цей користувач отримати доступ до даного ресурсу, на основі привілеїв користувача та будь-яких дозволів або інших специфікацій контролю доступу, які застосовуються до ресурсу.
Коли перевірки контролю доступу не застосовуються послідовно або взагалі не застосовуються, користувачі можуть отримувати доступ до даних або виконувати дії, які їм заборонено виконувати. Це може призвести до широкого спектру проблем, включаючи розкриття інформації, відмову в обслуговуванні та довільне виконання коду.
>  ### Відповідні платформи
>  #### Мови
> Клас: не залежить від мови (поширеність не визначена)
>  #### Технології
> Веб-сервер (часто поширений)
> Сервер бази даних (часто поширений)
>  ### Загальні наслідки
> |Область застосування | Вплив|
> |-|-|
> |Конфіденційність| Технічний вплив: читання даних програми; Читання файлів або каталогів<br/> Зловмисник може прочитати конфіденційні дані, прочитавши дані безпосередньо зі сховища даних, яке належним чином не обмежено, або отримавши доступ до недостатньо захищеної привілейованої функції для читання даних.|

> # CWE-200: Розкриття конфіденційної інформації неавторизованій особі
> ### Опис
Продукт надає конфіденційну інформацію суб’єкту, який не має явного дозволу на доступ до цієї інформації.
> ### Розширений опис
> Існує багато різних типів помилок, які спричиняють викриття інформації. Серйозність помилки може варіюватися в широкому діапазоні залежно від контексту, в якому працює продукт, типу конфіденційної інформації, яка розкривається, і переваг, які вона може надати зловмиснику. Деякі види конфіденційної інформації включають:
> - приватну особисту інформацію, таку як особисті повідомлення, фінансові дані, медичні записи, географічне розташування або контактні дані
> - стан системи та середовище, як-от операційна система та встановлені пакети
> - комерційна таємниця та інтелектуальна власність
> - статус і конфігурацію мережі
> - власний код продукту або внутрішній стан
> - метадані, напр. журналювання підключень або заголовків повідомлень
> - непряма інформація, така як невідповідність між двома внутрішніми операціями, яку може спостерігати стороння особа
> Інформація може бути конфіденційною для різних сторін, кожна з яких може мати власні очікування щодо того, чи потрібно захищати інформацію.Ці сторони включають:
> - власні користувачі продукту
> - люди чи організації, чию інформацію створює або використовує продукт, навіть якщо вони не є прямими користувачами продукту
> - адміністратори продукту, включаючи адміністраторів системи(-й) та/або мереж, у яких працює продукт
> - розробник
> Інформаційний вплив може відбуватися різними способами:
> - код явно вставляє конфіденційну інформацію до ресурсів або повідомлень, які навмисно зроблені доступними для неавторизованих учасників, але не повинні містити інформацію, тобто інформація повинна бути «очищена» або «дезінфікована»
> - інший недолік або помилка опосередковано вставляє конфіденційну інформацію до ресурсів, наприклад помилка веб-скрипту, що розкриває повний системний шлях програми.
> - код керує ресурсами, які навмисно містять конфіденційну інформацію, але ресурси ненавмисно стають доступними для неавторизованих учасників. У цьому випадку інформаційний вплив є результуючим – тобто інша слабкість уможливила доступ до інформації в першу чергу.
> Поширеною практикою є опис будь-якої втрати конфіденційності як «розкриття інформації», але це може призвести до надмірного використання CWE-200 у відображенні CWE. З точки зору CWE, втрата конфіденційності є технічним впливом, який може виникнути через десятки різних слабких місць, таких як незахищені дозволи на файли або читання поза межами. CWE-200 і його нащадки нижчого рівня призначені для покриття помилок, які виникають у поведінці, яка явно керує, зберігає, передає або очищає конфіденційну інформацію.
> ### Відповідні платформи
> #### Мови
> Клас: не залежить від мови (поширеність не визначена)
> ####Технології
> Клас: мобільний (невизначена поширеність)
> Загальні наслідки
>|Сфера застосування| Вплив|
>|-|-|
>|Конфіденційність | Технічний вплив: читати дані програми |
> ### Імовірність експлойту
> Високий

> # CWE-532: вставлення конфіденційної інформації у файл журналу
> ### Опис
> Інформація, записана до файлів журналу, може мати конфіденційний характер і давати цінні вказівки зловмиснику або розкривати конфіденційну інформацію користувача.
>### Розширений опис
>Хоча реєстрація всієї інформації може бути корисною на етапах розробки, важливо, щоб рівні реєстрації були належним чином встановлені перед надсиланням продукту, щоб конфіденційні дані користувача та системна інформація випадково не були доступні потенційним зловмисникам.
Різні файли журналу можуть створюватися та зберігатися для:
> - Файли журналу сервера (наприклад, server.log). Це може надати інформацію про те, яка програма залишила файл. Зазвичай це може давати повні імена шляхів і системну інформацію, а іноді імена користувачів і паролі.
> - файли журналу, які використовуються для налагодження
> ### Загальні наслідки
>|Сфера застосування| Вплив|
>|-|-|
>|Конфіденційність|Технічний вплив: читати дані програми|
>Реєстрація конфіденційних даних користувача часто надає зловмисникам додатковий, менш захищений шлях до отримання інформації.
> ### Імовірність експлойту
> Середній

> ## CWE-327: використання зламаного або ризикованого криптографічного алгоритму
> ### Опис
> Продукт використовує несправний або ризикований криптографічний алгоритм або протокол.
> ### Розширений опис
> Криптографічні алгоритми — це методи, за допомогою яких дані кодуються, щоб запобігти спостереженню або впливу з боку неавторизованих осіб. Незахищену криптографію можна використати для розкриття конфіденційної інформації, зміни даних несподіваними способами, підробки ідентифікаційних даних інших користувачів або пристроїв або інших впливів.
Дуже важко створити безпечний алгоритм, і навіть високопрофільні алгоритми досвідчених експертів з криптографії були зламані. Існують добре відомі методи зламу або послаблення різних видів криптографії. Відповідно, існує невелика кількість добре зрозумілих і ретельно вивчених алгоритмів, які слід використовувати в більшості продуктів. Використання нестандартного або завідомо незахищеного алгоритму є небезпечним, оскільки рішучий зловмисник може зламати алгоритм і скомпрометувати будь-які захищені дані.
Оскільки стан криптографії розвивається настільки швидко, алгоритм зазвичай вважають «небезпечним», навіть якщо раніше він вважався надійним. Це може статися, коли виявлено нові атаки, або якщо обчислювальна потужність зростає настільки, що криптографічний алгоритм більше не забезпечує рівень захисту, який спочатку вважався.
З ряду причин цю слабкість ще складніше впоратися за допомогою апаратного розгортання криптографічних алгоритмів на відміну від реалізації програмного забезпечення.По-перше, якщо за допомогою апаратно реалізованої криптографії виявлено дефект, у більшості випадків його неможливо виправити без відкликання продукту, оскільки апаратне забезпечення нелегко замінити, як програмне забезпечення. По-друге, оскільки очікується, що апаратний продукт працюватиме роками, обчислювальна потужність супротивника з часом лише зростатиме.
> ### Відповідні платформи
> #### Мови
>Клас: не залежить від мови (поширеність не визначена)
Verilog (невизначена поширеність)
VHDL (невизначена поширеність)
>#### Технології
>Клас: не технологічно (невизначена поширеність)
Клас: ICS/OT (невизначена поширеність)
>### Загальні наслідки
>|Обсяг |Вплив|
>|-|-|
>|Конфіденційність|Технічний вплив: читайте дані програми<br/>Конфіденційність конфіденційних даних може бути порушена через використання зламаного або ризикованого криптографічного алгоритму.|
>|Цілісність|Технічний вплив: змінити дані програми<br/>Цілісність конфіденційних даних може бути порушена через використання зламаного або ризикованого криптографічного алгоритму.|
>|Відповідальність<br/>Не відмова|Технічний вплив: приховати дії<br/>Якщо криптографічний алгоритм використовується для забезпечення ідентичності джерела даних (наприклад, цифрових підписів), то несправний алгоритм скомпрометує цю схему, і джерело даних неможливо підтвердити.|
> ### Імовірність експлойту
> Високий

> ## CWE-285: Неналежний дозвіл
> ### Опис
> Продукт не виконує або неправильно виконує перевірку авторизації, коли актор намагається отримати доступ до ресурсу або виконати дію.
> ### Розширений опис
> Якщо припустити, що користувач має певний ідентифікатор, авторизація – це процес визначення того, чи може цей користувач отримати доступ до даного ресурсу, на основі привілеїв користувача та будь-яких дозволів або інших специфікацій контролю доступу, які застосовуються до ресурсу.
Коли перевірки контролю доступу не застосовуються послідовно або взагалі не застосовуються, користувачі можуть отримувати доступ до даних або виконувати дії, які їм заборонено виконувати. Це може призвести до широкого спектру проблем, включаючи розкриття інформації, відмову в обслуговуванні та довільне виконання коду.
> ### Відповідні платформи
> #### Мови
> Клас: не залежить від мови (поширеність не визначена)
> #### Технології
> Веб-сервер (часто поширений)
> Сервер бази даних (часто поширений)
> ### Загальні наслідки
>|Сфера застосування| Вплив|
>|-|-|
>|Конфіденційність|Технічний вплив: читати дані програми; Читання файлів або каталогів<br/>Зловмисник може прочитати конфіденційні дані, зчитавши дані безпосередньо зі сховища даних, яке не обмежено належним чином, або отримавши доступ до недостатньо захищеної привілейованої функції для читання даних.
>|Цілісність|Технічний вплив: зміна даних програми; Змінити файли чи каталоги<br/>Зловмисник може змінити конфіденційні дані, записавши дані безпосередньо в сховище даних, яке не має належних обмежень, або використовуючи для запису даних недостатньо захищені привілейовані функції.|
>|Контроль доступу |Технічний вплив: отримання привілеїв або припущення особи<br/>Зловмисник може отримати привілеї шляхом безпосередньої зміни чи читання критичних даних або доступу до недостатньо захищених привілейованих функцій.|
> ### Імовірність експлойту
> Високий